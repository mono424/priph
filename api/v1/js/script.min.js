function request(e,t){if(requestLock){for(;is_request;);is_request=1}$.get(url+"?"+e,function(e){is_request=0,t&&t(e)},"json")}function uploadFileRequest(e,t,n,i){request("action=create-upload-token",function(u){if(u.error)return void n(!1);var r=u.response,s=new FormData;s.append("file",t),$.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=e.loaded/e.total;i&&i(t)}},!1),e},url:url+"?token="+r+"&"+e,dataType:"json",cache:!1,contentType:!1,processData:!1,data:s,type:"post",success:function(e){n&&n(e)},done:function(e){},error:function(e){n(!1)}})})}function login(e,t,n){request("action=login&user="+e+"&pass="+t,n)}function register(e,t){request("action=register&user="+e,t)}function verify(e,t,n,i,u){request("action=verify&user="+e+"&verification="+t+"&pass="+n+"&displayname="+i,u)}function checkLogin(e){request("action=loginByCookie",e)}function userInfo(e){request("action=user-info",e)}function userGetPictures(e){request("action=user-get-pictures",e)}function userGetSessions(e){request("action=user-get-sessions",e)}function userLogout(e){request("action=logout",e)}function updateProfilePicture(e,t,n){uploadFileRequest("action=uploadProfilePicture",e,t,n)}function updateDisplayname(e,t){request("action=user-change-displayname&displayname="+e,t)}function updatePassword(e,t,n){request("action=user-change-password&pass="+e+"&new_pass="+t,n)}function uploadPicture(e,t,n){uploadFileRequest("action=uploadPicture",e,t,n)}function generatePrivateImageUrl(e,t,n){var i="";return t&&n&&(i="&width="+t+"&height="+n),url+"?action=getPicture&id="+e+i}function profilePictureUrl(e,t,n){var i="";return e&&(i="&user="+e),t&&n&&(i+="&width="+t+"&height="+n),url+"?action=getProfilePicture"+i}function deletePicture(e,t){request("action=deletePicture&id="+e,t)}function deleteSession(e,t){request("action=user-session-delete&session="+e,t)}function admin_getUsers(e,t,n,i,u,r){var s="";n&&(s+="&user="+n),i&&(s+="&email="+i),u&&(s+="&displayname="+u),request("action=admin-get-user&page="+e+"&limit="+t+s,r)}function admin_lockUser(e,t){request("action=admin-lock-user&user="+e,t)}function admin_unlockUser(e,t){request("action=admin-unlock-user&user="+e,t)}function admin_giveAdminRights(e,t){request("action=admin-give-admin-rights&user="+e,t)}function admin_stripAdminRights(e,t){request("action=admin-strip-admin-rights&user="+e,t)}function admin_deauthUser(e,t){request("action=admin-deauth-user&user="+e,t)}function admin_deleteUser(e,t){request("action=admin-delete-user&user="+e,t)}var url="http://priph.com/api/v1/",is_request=0,requestLock=!1;
